---
# One-time Docker setup on control node
# Usage: ansible-playbook playbooks/docker-setup.yaml
#
# NOTE: Running Docker on a k8s control plane is atypical. We do this to
# simulate managed services (RDS, MSK) that would run outside the cluster.
# In production, you would use actual managed services or dedicated
# infrastructure clusters - not Docker on the control plane.

- name: Install Docker on control node
  hosts: k3s_server
  become: true
  roles:
    - docker

  post_tasks:
    - name: Confirm Docker is ready
      ansible.builtin.debug:
        msg: |
          Docker installed on {{ inventory_hostname }}.

          This node will run Postgres and Kafka via Docker Compose,
          simulating managed services that k8s workloads connect to.

          Next: Run 'make infra' to deploy the infrastructure containers.
